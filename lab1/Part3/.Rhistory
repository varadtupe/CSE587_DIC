geom_col(width = 1) +
#scale_fill_manual(values = c("red", "yellow")) +
coord_polar("y", start = 0*pi / 2,direction = -1) +
labs(title = 'Influenza A (H1 N1)pdm09')
ggplot(part3Data[part3Data$X.Sub.type == 'B/Yamagata',], aes(x = "", y = X..of..Sub.type.Total, fill = Genetic_Group)) +
geom_col(width = 1) +
#scale_fill_manual(values = c("red", "yellow")) +
coord_polar("y", start = 0*pi / 2,direction = -1) +
labs(title = 'Influenza B Victoria')
ggplot(part3Data[part3Data$X.Sub.type == 'H1pdm09',], aes(x = "", y = X..of..Sub.type.Total, fill = Genetic_Group)) +
geom_col(width = 1) +
#scale_fill_manual(values = c("red", "yellow")) +
coord_polar("y", start = 0*pi / 2,direction = -1) +
labs(title = 'Influenza B Yamagata')
part3Data$X..of..Sub.type.Total = as.character(part3Data$X..of..Sub.type.Total)
part3Data$X..of..Sub.type.Total = gsub('%', '', part3Data$X..of..Sub.type.Total)
part3Data$X..of..Sub.type.Total = as.numeric(part3Data$X..of..Sub.type.Total)
############################################################
#Graph 3:
############################################################
part3Data = read.csv('./Part2/3_piechart.csv',header = T,sep = ',',fill = TRUE)
attach(part3Data)
library(ggplot2)
nm = c('Influenza A (H3 N2)','Influenza A (H1 N1)pdm09','Influenza A (subtype unknown)','Influenza B Victoria','Influenza B Yamagata','Influenza B lineage not determined')
val = c(18068,1896,348,2292,228,921)
valchar = as.character(c("18068","1896","348","2292","228","921"))
mainPie = data.frame(nm,val)
ggplot(mainPie, aes(x = "", y = val, fill =valchar)) +geom_col(width = 1) +
#scale_fill_discrete("fill",values = c("red","orange", "yellow","lightgreen","green","dark")) +
scale_fill_manual(values = c("red","orange", "yellow","lightgreen","green","darkgreen"), labels = nm) +
coord_polar("y", start = 0*pi / 2,direction = -1) +
labs(title = "Influenza Positive Specimen Reported by \n U.S. Public Health Laboratories, \n Cumulative, 2017-2018 season")
part3Data$X..of..Sub.type.Total = as.character(part3Data$X..of..Sub.type.Total)
part3Data$X..of..Sub.type.Total = gsub('%', '', part3Data$X..of..Sub.type.Total)
part3Data$X..of..Sub.type.Total = as.numeric(part3Data$X..of..Sub.type.Total)
part3Data$X..of..Sub.type.Total[which(is.na(part3Data$X..of..Sub.type.Total))] <- 0
ggplot(part3Data[part3Data$X.Sub.type == 'H3',], aes(x = "", y = X..of..Sub.type.Total, fill = Genetic_Group)) +
geom_col(width = 1) +
#scale_fill_manual(values = c("red", "yellow")) +
coord_polar("y", start = 0*pi / 2,direction = -1) +
labs(title = "Influenza A (H3 N2)")
ggplot(part3Data[part3Data$X.Sub.type == 'B/Victoria',], aes(x = "", y = X..of..Sub.type.Total, fill = Genetic_Group)) +
geom_col(width = 1) +
#scale_fill_manual(values = c("red", "yellow")) +
coord_polar("y", start = 0*pi / 2,direction = -1) +
labs(title = 'Influenza A (H1 N1)pdm09')
ggplot(part3Data[part3Data$X.Sub.type == 'B/Yamagata',], aes(x = "", y = X..of..Sub.type.Total, fill = Genetic_Group)) +
geom_col(width = 1) +
#scale_fill_manual(values = c("red", "yellow")) +
coord_polar("y", start = 0*pi / 2,direction = -1) +
labs(title = 'Influenza B Victoria')
ggplot(part3Data[part3Data$X.Sub.type == 'H1pdm09',], aes(x = "", y = X..of..Sub.type.Total, fill = Genetic_Group)) +
geom_col(width = 1) +
#scale_fill_manual(values = c("red", "yellow")) +
coord_polar("y", start = 0*pi / 2,direction = -1) +
labs(title = 'Influenza B Yamagata')
part3Data$X..of..Sub.type.Total = as.character(part3Data$X..of..Sub.type.Total)
part3Data$X..of..Sub.type.Total = gsub('%', '', part3Data$X..of..Sub.type.Total)
part3Data$X..of..Sub.type.Total = as.numeric(part3Data$X..of..Sub.type.Total)
part3Data$X..of..Sub.type.Total[which(is.na(part3Data$X..of..Sub.type.Total))] <- 0
ggplot(part3Data[part3Data$X.Sub.type == 'H3',], aes(x = "", y = X..of..Sub.type.Total, fill = Genetic_Group)) +
geom_col(width = 1) +
#scale_fill_manual(values = c("red", "yellow")) +
coord_polar("y", start = 0*pi / 2,direction = -1) +
labs(title = "Influenza A (H3 N2)")
ggplot(part3Data[part3Data$X.Sub.type == 'B/Victoria',], aes(x = "", y = X..of..Sub.type.Total, fill = Genetic_Group)) +
geom_col(width = 1) +
#scale_fill_manual(values = c("red", "yellow")) +
coord_polar("y", start = 0*pi / 2,direction = -1) +
labs(title = 'Influenza A (H1 N1)pdm09')
ggplot(part3Data[part3Data$X.Sub.type == 'B/Yamagata',], aes(x = "", y = X..of..Sub.type.Total, fill = Genetic_Group)) +
geom_col(width = 1) +
#scale_fill_manual(values = c("red", "yellow")) +
coord_polar("y", start = 0*pi / 2,direction = -1) +
labs(title = 'Influenza B Victoria')
ggplot(part3Data[part3Data$X.Sub.type == 'H1pdm09',], aes(x = "", y = X..of..Sub.type.Total, fill = Genetic_Group)) +
geom_col(width = 1) +
#scale_fill_manual(values = c("red", "yellow")) +
coord_polar("y", start = 0*pi / 2,direction = -1) +
labs(title = 'Influenza B Yamagata')
############################################################
#Graph 3:
############################################################
part3Data = read.csv('./Part2/3_piechart.csv',header = T,sep = ',',fill = TRUE)
attach(part3Data)
library(ggplot2)
nm = c('Influenza A (H3 N2)','Influenza A (H1 N1)pdm09','Influenza A (subtype unknown)','Influenza B Victoria','Influenza B Yamagata','Influenza B lineage not determined')
val = c(18068,1896,348,2292,228,921)
valchar = as.character(c("18068","1896","348","2292","228","921"))
mainPie = data.frame(nm,val)
ggplot(mainPie, aes(x = "", y = val, fill =valchar)) +geom_col(width = 1) +
#scale_fill_discrete("fill",values = c("red","orange", "yellow","lightgreen","green","dark")) +
scale_fill_manual(values = c("red","orange", "yellow","lightgreen","green","darkgreen"), labels = nm) +
coord_polar("y", start = 0*pi / 2,direction = -1) +
labs(title = "Influenza Positive Specimen Reported by \n U.S. Public Health Laboratories, \n Cumulative, 2017-2018 season")
part3Data$X..of..Sub.type.Total = as.character(part3Data$X..of..Sub.type.Total)
part3Data$X..of..Sub.type.Total = gsub('%', '', part3Data$X..of..Sub.type.Total)
part3Data$X..of..Sub.type.Total = as.numeric(part3Data$X..of..Sub.type.Total)
part3Data$X..of..Sub.type.Total[which(is.na(part3Data$X..of..Sub.type.Total))] <- 0
ggplot(part3Data[part3Data$X.Sub.type == 'H3',], aes(x = "", y = X..of..Sub.type.Total, fill = Genetic_Group)) +
geom_col(width = 1) +
#scale_fill_manual(values = c("red", "yellow")) +
coord_polar("y", start = 0*pi / 2,direction = -1) +
labs(title = "Influenza A (H3 N2)")
ggplot(part3Data[part3Data$X.Sub.type == 'B/Victoria',], aes(x = "", y = X..of..Sub.type.Total, fill = Genetic_Group)) +
geom_col(width = 1) +
#scale_fill_manual(values = c("red", "yellow")) +
coord_polar("y", start = 0*pi / 2,direction = -1) +
labs(title = 'Influenza A (H1 N1)pdm09')
ggplot(part3Data[part3Data$X.Sub.type == 'B/Yamagata',], aes(x = "", y = X..of..Sub.type.Total, fill = Genetic_Group)) +
geom_col(width = 1) +
#scale_fill_manual(values = c("red", "yellow")) +
coord_polar("y", start = 0*pi / 2,direction = -1) +
labs(title = 'Influenza B Victoria')
ggplot(part3Data[part3Data$X.Sub.type == 'H1pdm09',], aes(x = "", y = X..of..Sub.type.Total, fill = Genetic_Group)) +
geom_col(width = 1) +
#scale_fill_manual(values = c("red", "yellow")) +
coord_polar("y", start = 0*pi / 2,direction = -1) +
labs(title = 'Influenza B Yamagata')
ggplot(mainPie, aes(x = "", y = val, fill =valchar)) +geom_col(width = 1) +
#scale_fill_discrete("fill",values = c("red","orange", "yellow","lightgreen","green","dark")) +
scale_fill_manual(values = c("red","orange", "yellow","lightgreen","green","darkgreen"), labels = nm) +
coord_polar("y", start = 0*pi / 2,direction = -1) +
labs(title = "Influenza Positive Specimen Reported by \n U.S. Public Health Laboratories, \n Cumulative, 2017-2018 season") + xlab("") +  ylab("")
############################################################
#Graph 3:
############################################################
part3Data = read.csv('./Part2/3_piechart.csv',header = T,sep = ',',fill = TRUE)
attach(part3Data)
library(ggplot2)
nm = c('Influenza A (H3 N2)','Influenza A (H1 N1)pdm09','Influenza A (subtype unknown)','Influenza B Victoria','Influenza B Yamagata','Influenza B lineage not determined')
val = c(18068,1896,348,2292,228,921)
valchar = as.character(c("18068","1896","348","2292","228","921"))
mainPie = data.frame(nm,val)
ggplot(mainPie, aes(x = "", y = val, fill =valchar)) +geom_col(width = 1) +
#scale_fill_discrete("fill",values = c("red","orange", "yellow","lightgreen","green","dark")) +
scale_fill_manual(values = c("red","orange", "yellow","lightgreen","green","darkgreen"), labels = nm) +
coord_polar("y", start = 0*pi / 2,direction = -1) +
labs(title = "Influenza Positive Specimen Reported by \n U.S. Public Health Laboratories, \n Cumulative, 2017-2018 season") + xlab("") +  ylab("")
part3Data$X..of..Sub.type.Total = as.character(part3Data$X..of..Sub.type.Total)
part3Data$X..of..Sub.type.Total = gsub('%', '', part3Data$X..of..Sub.type.Total)
part3Data$X..of..Sub.type.Total = as.numeric(part3Data$X..of..Sub.type.Total)
part3Data$X..of..Sub.type.Total[which(is.na(part3Data$X..of..Sub.type.Total))] <- 0
ggplot(part3Data[part3Data$X.Sub.type == 'H3',], aes(x = "", y = X..of..Sub.type.Total, fill = Genetic_Group)) +
geom_col(width = 1) +
#scale_fill_manual(values = c("red", "yellow")) +
coord_polar("y", start = 0*pi / 2,direction = -1) +
labs(title = "Influenza A (H3 N2)") + xlab("") +  ylab("")
ggplot(part3Data[part3Data$X.Sub.type == 'B/Victoria',], aes(x = "", y = X..of..Sub.type.Total, fill = Genetic_Group)) +
geom_col(width = 1) +
#scale_fill_manual(values = c("red", "yellow")) +
coord_polar("y", start = 0*pi / 2,direction = -1) +
labs(title = 'Influenza A (H1 N1)pdm09') + xlab("") +  ylab("")
ggplot(part3Data[part3Data$X.Sub.type == 'B/Yamagata',], aes(x = "", y = X..of..Sub.type.Total, fill = Genetic_Group)) +
geom_col(width = 1) +
#scale_fill_manual(values = c("red", "yellow")) +
coord_polar("y", start = 0*pi / 2,direction = -1) +
labs(title = 'Influenza B Victoria') + xlab("") +  ylab("")
ggplot(part3Data[part3Data$X.Sub.type == 'H1pdm09',], aes(x = "", y = X..of..Sub.type.Total, fill = Genetic_Group)) +
geom_col(width = 1) +
#scale_fill_manual(values = c("red", "yellow")) +
coord_polar("y", start = 0*pi / 2,direction = -1) +
labs(title = 'Influenza B Yamagata') + xlab("") +  ylab("")
plotS1 + geom_bar(aes(x = Week, y=as.numeric(as.character(Total.A))+ as.numeric(as.character(Total.B))),
fill="yellow",stat = "identity")+
geom_bar(aes(x = Week, y=as.numeric(as.character(Total.B))),fill="dark green",stat = "identity")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.A))), colour="blue",group = 1)+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.B.))), colour="green",group = 1)+
geom_line(aes(x=Week, y=700*as.numeric(as.character(X..Positive))), colour="black",group = 1)+
scale_y_continuous("Number of Positive Specimen", sec.axis = sec_axis(~ . * 0.0015, name ="Percent Positive")) + theme(axis.text.x = element_text(angle = 70, hjust = 1)) ggtitle("Influenza Positive Tests Reported to CDC \n by U.S. Clinical Laboratories 2017-2018 Season")
plotS1 + geom_bar(aes(x = Week, y=as.numeric(as.character(Total.A))+ as.numeric(as.character(Total.B))),
fill="yellow",stat = "identity")+
geom_bar(aes(x = Week, y=as.numeric(as.character(Total.B))),fill="dark green",stat = "identity")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.A))), colour="blue",group = 1)+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.B.))), colour="green",group = 1)+
geom_line(aes(x=Week, y=700*as.numeric(as.character(X..Positive))), colour="black",group = 1)+
scale_y_continuous("Number of Positive Specimen", sec.axis = sec_axis(~ . * 0.0015, name ="Percent Positive")) + theme(axis.text.x = element_text(angle = 70, hjust = 1))  + ggtitle("Influenza Positive Tests Reported to CDC \n by U.S. Clinical Laboratories 2017-2018 Season")
plotS1 + geom_bar(aes(x = Week, y=as.numeric(as.character(Total.A))+ as.numeric(as.character(Total.B))),
fill="yellow",stat = "identity")+
geom_bar(aes(x = Week, y=as.numeric(as.character(Total.B))),fill="dark green",stat = "identity")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.A))), colour="blue",group = 1)+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.B.))), colour="green",group = 1)+
geom_line(aes(x=Week, y=700*as.numeric(as.character(X..Positive))), colour="black",group = 1)+
scale_y_continuous("Number of Positive Specimen", sec.axis = sec_axis(~ . * 0.0015, name ="Percent Positive")) + theme(axis.text.x = element_text(angle = 70, hjust = 1))  + ggtitle("Influenza Positive Tests Reported to CDC \n by U.S. Clinical Laboratories 2017-2018 Season") + legend("A")
plotS1 + geom_bar(aes(x = Week, y=as.numeric(as.character(Total.A))+ as.numeric(as.character(Total.B))),
fill="yellow",stat = "identity")+
geom_bar(aes(x = Week, y=as.numeric(as.character(Total.B))),fill="dark green",stat = "identity")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.A))), colour="blue",group = 1)+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.B.))), colour="green",group = 1)+
geom_line(aes(x=Week, y=700*as.numeric(as.character(X..Positive))), colour="black",group = 1)+
scale_y_continuous("Number of Positive Specimen", sec.axis = sec_axis(~ . * 0.0015, name ="Percent Positive")) + theme(axis.text.x = element_text(angle = 70, hjust = 1))  + ggtitle("Influenza Positive Tests Reported to CDC \n by U.S. Clinical Laboratories 2017-2018 Season") + legend(c("A","B","C","D","E"))
plotS1 + geom_bar(aes(x = Week, y=as.numeric(as.character(Total.A))+ as.numeric(as.character(Total.B))),
fill="yellow",stat = "identity")+
geom_bar(aes(x = Week, y=as.numeric(as.character(Total.B))),fill="dark green",stat = "identity")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.A))), colour="blue",group = 1)+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.B.))), colour="green",group = 1)+
geom_line(aes(x=Week, y=700*as.numeric(as.character(X..Positive))), colour="black",group = 1)+
scale_y_continuous("Number of Positive Specimen", sec.axis = sec_axis(~ . * 0.0015, name ="Percent Positive")) + theme(axis.text.x = element_text(angle = 70, hjust = 1))  + ggtitle("Influenza Positive Tests Reported to CDC \n by U.S. Clinical Laboratories 2017-2018 Season") + legend(legend = c("A","B","C","D","E"))
plotS1 + geom_bar(aes(x = Week, y=as.numeric(as.character(Total.A))+ as.numeric(as.character(Total.B))),
fill="yellow",stat = "identity")+
geom_bar(aes(x = Week, y=as.numeric(as.character(Total.B))),fill="dark green",stat = "identity")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.A))), colour="blue",group = 1)+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.B.))), colour="green",group = 1)+
geom_line(aes(x=Week, y=700*as.numeric(as.character(X..Positive))), colour="black",group = 1)+
scale_y_continuous("Number of Positive Specimen", sec.axis = sec_axis(~ . * 0.0015, name ="Percent Positive")) + theme(axis.text.x = element_text(angle = 70, hjust = 1))  + ggtitle("Influenza Positive Tests Reported to CDC \n by U.S. Clinical Laboratories 2017-2018 Season") + legend(x = c("A","B","C","D","E"))
plotS1 + geom_bar(aes(x = Week, y=as.numeric(as.character(Total.A))+ as.numeric(as.character(Total.B))),
fill="yellow",stat = "identity")+
geom_bar(aes(x = Week, y=as.numeric(as.character(Total.B))),fill="dark green",stat = "identity")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.A))), colour="blue",group = 1)+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.B.))), colour="green",group = 1)+
geom_line(aes(x=Week, y=700*as.numeric(as.character(X..Positive))), colour="black",group = 1)+
scale_y_continuous("Number of Positive Specimen", sec.axis = sec_axis(~ . * 0.0015, name ="Percent Positive")) + theme(axis.text.x = element_text(angle = 70, hjust = 1))  + ggtitle("Influenza Positive Tests Reported to CDC \n by U.S. Clinical Laboratories 2017-2018 Season") + legend(x ="top", c("A","B","C","D","E"))
plotS1 + geom_bar(aes(x = Week, y=as.numeric(as.character(Total.A))+ as.numeric(as.character(Total.B))),
fill="yellow",stat = "identity")+
geom_bar(aes(x = Week, y=as.numeric(as.character(Total.B))),fill="dark green",stat = "identity")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.A))), colour="blue",group = 1)+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.B.))), colour="green",group = 1)+
geom_line(aes(x=Week, y=700*as.numeric(as.character(X..Positive))), colour="black",group = 1)+
scale_y_continuous("Number of Positive Specimen", sec.axis = sec_axis(~ . * 0.0015, name ="Percent Positive")) + theme(axis.text.x = element_text(angle = 70, hjust = 1))  + ggtitle("Influenza Positive Tests Reported to CDC \n by U.S. Clinical Laboratories 2017-2018 Season") + legend(x ="top", units = c("A","B","C","D","E"))
plotS1 + geom_bar(aes(x = Week, y=as.numeric(as.character(Total.A))+ as.numeric(as.character(Total.B))),
fill="yellow",stat = "identity")+
geom_bar(aes(x = Week, y=as.numeric(as.character(Total.B))),fill="dark green",stat = "identity")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.A))), colour="blue",group = 1)+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.B.))), colour="green",group = 1)+
geom_line(aes(x=Week, y=700*as.numeric(as.character(X..Positive))), colour="black",group = 1)+
scale_y_continuous("Number of Positive Specimen", sec.axis = sec_axis(~ . * 0.0015, name ="Percent Positive")) + theme(axis.text.x = element_text(angle = 70, hjust = 1))  + ggtitle("Influenza Positive Tests Reported to CDC \n by U.S. Clinical Laboratories 2017-2018 Season") + legend(x ="top", c("A","B","C","D","E"))
plotS1 + geom_bar(aes(x = Week, y=as.numeric(as.character(Total.A))+ as.numeric(as.character(Total.B))),
fill="yellow",stat = "identity")+
geom_bar(aes(x = Week, y=as.numeric(as.character(Total.B))),fill="dark green",stat = "identity")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.A))), colour="blue",group = 1)+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.B.))), colour="green",group = 1)+
geom_line(aes(x=Week, y=700*as.numeric(as.character(X..Positive))), colour="black",group = 1)+
scale_y_continuous("Number of Positive Specimen", sec.axis = sec_axis(~ . * 0.0015, name ="Percent Positive")) + theme(axis.text.x = element_text(angle = 70, hjust = 1))  + ggtitle("Influenza Positive Tests Reported to CDC \n by U.S. Clinical Laboratories 2017-2018 Season") + legend(x ="top")
plotS1 + geom_bar(aes(x = Week, y=as.numeric(as.character(Total.A))+ as.numeric(as.character(Total.B))),
fill="yellow",stat = "identity",label = "A")+
geom_bar(aes(x = Week, y=as.numeric(as.character(Total.B))),fill="dark green",stat = "identity" , label = "B")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.A))), colour="blue",group = 1)+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.B.))), colour="green",group = 1)+
geom_line(aes(x=Week, y=700*as.numeric(as.character(X..Positive))), colour="black",group = 1)+
scale_y_continuous("Number of Positive Specimen", sec.axis = sec_axis(~ . * 0.0015, name ="Percent Positive")) + theme(axis.text.x = element_text(angle = 70, hjust = 1))  + ggtitle("Influenza Positive Tests Reported to CDC \n by U.S. Clinical Laboratories 2017-2018 Season") + legend(x ="top")
plotS1 + geom_bar(aes(x = Week, y=as.numeric(as.character(Total.A))+ as.numeric(as.character(Total.B))),
fill="yellow",stat = "identity",label = "A")+
geom_bar(aes(x = Week, y=as.numeric(as.character(Total.B))),fill="dark green",stat = "identity" , label = "B")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.A))), colour="blue",group = 1)+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.B.))), colour="green",group = 1)+
geom_line(aes(x=Week, y=700*as.numeric(as.character(X..Positive))), colour="black",group = 1)+
scale_y_continuous("Number of Positive Specimen", sec.axis = sec_axis(~ . * 0.0015, name ="Percent Positive")) + theme(axis.text.x = element_text(angle = 70, hjust = 1))  + ggtitle("Influenza Positive Tests Reported to CDC \n by U.S. Clinical Laboratories 2017-2018 Season")
plotS1 + geom_bar(aes(x = Week, y=as.numeric(as.character(Total.A))+ as.numeric(as.character(Total.B))),
fill="yellow",stat = "identity",label = "A")+
geom_bar(aes(x = Week, y=as.numeric(as.character(Total.B))),fill="dark green",stat = "identity" , label = "B")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.A))), colour="blue",group = 1,label = "% Positive")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.B.))), colour="green",group = 1, label = "% Positive Flu A")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(X..Positive))), colour="black",group = 1 , label = "% Positive Flu B")+
scale_y_continuous("Number of Positive Specimen", sec.axis = sec_axis(~ . * 0.0015, name ="Percent Positive")) + theme(axis.text.x = element_text(angle = 70, hjust = 1))  + ggtitle("Influenza Positive Tests Reported to CDC \n by U.S. Clinical Laboratories 2017-2018 Season")
plotS1 + geom_bar(aes(x = Week, y=as.numeric(as.character(Total.A))+ as.numeric(as.character(Total.B))),
fill="yellow",stat = "identity",label = "A")+
geom_bar(aes(x = Week, y=as.numeric(as.character(Total.B))),fill="dark green",stat = "identity" , labels = "B")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.A))), colour="blue",group = 1,labels = "% Positive")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.B.))), colour="green",group = 1, label = "% Positive Flu A")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(X..Positive))), colour="black",group = 1 , label = "% Positive Flu B")+
scale_y_continuous("Number of Positive Specimen", sec.axis = sec_axis(~ . * 0.0015, name ="Percent Positive")) + theme(axis.text.x = element_text(angle = 70, hjust = 1))  + ggtitle("Influenza Positive Tests Reported to CDC \n by U.S. Clinical Laboratories 2017-2018 Season")
plotS1 + geom_bar(aes(x = Week, y=as.numeric(as.character(Total.A))+ as.numeric(as.character(Total.B))),
fill="yellow",stat = "identity",labels = "A")+
geom_bar(aes(x = Week, y=as.numeric(as.character(Total.B))),fill="dark green",stat = "identity" , labels = "B")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.A))), colour="blue",group = 1,labels = "% Positive")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.B.))), colour="green",group = 1, labels = "% Positive Flu A")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(X..Positive))), colour="black",group = 1 , labels = "% Positive Flu B")+
scale_y_continuous("Number of Positive Specimen", sec.axis = sec_axis(~ . * 0.0015, name ="Percent Positive")) + theme(axis.text.x = element_text(angle = 70, hjust = 1))  + ggtitle("Influenza Positive Tests Reported to CDC \n by U.S. Clinical Laboratories 2017-2018 Season")
plotS1 + geom_bar(aes(x = Week, y=as.numeric(as.character(Total.A))+ as.numeric(as.character(Total.B))),
fill="yellow",stat = "identity",labels = "A")+
geom_bar(aes(x = Week, y=as.numeric(as.character(Total.B))),fill="dark green",stat = "identity" , labels = "B")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.A))), colour="blue",group = 1,labels = "% Positive")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.B.))), colour="green",group = 1, labels = "% Positive Flu A")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(X..Positive))), colour="black",group = 1 , labels = "% Positive Flu B")+
scale_y_continuous("Number of Positive Specimen", sec.axis = sec_axis(~ . * 0.0015, name ="Percent Positive")) + theme(axis.text.x = element_text(angle = 70, hjust = 1))  + ggtitle("Influenza Positive Tests Reported to CDC \n by U.S. Clinical Laboratories 2017-2018 Season") + legend("top")
plotS1 + geom_bar(aes(x = Week, y=as.numeric(as.character(Total.A))+ as.numeric(as.character(Total.B))),
fill="yellow",stat = "identity",labels = "A")+
geom_bar(aes(x = Week, y=as.numeric(as.character(Total.B))),fill="dark green",stat = "identity" , labels = "B")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.A))), colour="blue",group = 1,labels = "% Positive")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.B.))), colour="green",group = 1, labels = "% Positive Flu A")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(X..Positive))), colour="black",group = 1 , labels = "% Positive Flu B")+
scale_y_continuous("Number of Positive Specimen", sec.axis = sec_axis(~ . * 0.0015, name ="Percent Positive")) + theme(axis.text.x = element_text(angle = 70, hjust = 1))  + ggtitle("Influenza Positive Tests Reported to CDC \n by U.S. Clinical Laboratories 2017-2018 Season") + legend(x = "top")
plotS1 + geom_bar(aes(x = Week, y=as.numeric(as.character(Total.A))+ as.numeric(as.character(Total.B))),
fill="yellow",stat = "identity",labels = "A")+
geom_bar(aes(x = Week, y=as.numeric(as.character(Total.B))),fill="dark green",stat = "identity" , labels = "B")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.A))), colour="blue",group = 1,labels = "% Positive")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.B.))), colour="green",group = 1, labels = "% Positive Flu A")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(X..Positive))), colour="black",group = 1 , labels = "% Positive Flu B")+
scale_y_continuous("Number of Positive Specimen", sec.axis = sec_axis(~ . * 0.0015, name ="Percent Positive")) + theme(axis.text.x = element_text(angle = 70, hjust = 1))  + ggtitle("Influenza Positive Tests Reported to CDC \n by U.S. Clinical Laboratories 2017-2018 Season") + legend("top",c("A","B", "5","c","a"))
plotS1 + geom_bar(aes(x = Week, y=as.numeric(as.character(Total.A))+ as.numeric(as.character(Total.B))),
fill="yellow",stat = "identity",labels = "A")+
geom_bar(aes(x = Week, y=as.numeric(as.character(Total.B))),fill="dark green",stat = "identity" , labels = "B")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.A))), colour="blue",group = 1,labels = "% Positive")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.B.))), colour="green",group = 1, labels = "% Positive Flu A")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(X..Positive))), colour="black",group = 1 , labels = "% Positive Flu B")+
scale_y_continuous("Number of Positive Specimen", sec.axis = sec_axis(~ . * 0.0015, name ="Percent Positive")) + theme(axis.text.x = element_text(angle = 70, hjust = 1))  + ggtitle("Influenza Positive Tests Reported to CDC \n by U.S. Clinical Laboratories 2017-2018 Season")
plotS1 + geom_bar(aes(x = Week, y=as.numeric(as.character(Total.A))+ as.numeric(as.character(Total.B))),
fill="yellow",stat = "identity",labels = "A")+
geom_bar(aes(x = Week, y=as.numeric(as.character(Total.B))),fill="dark green",stat = "identity" , labels = "B")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.A))), colour="blue",group = 1,labels = "% Positive")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.B.))), colour="green",group = 1, labels = "% Positive Flu A")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(X..Positive))), colour="black",group = 1 , labels = "% Positive Flu B")+
scale_y_continuous("Number of Positive Specimen", sec.axis = sec_axis(~ . * 0.0015, name ="Percent Positive")) + theme(axis.text.x = element_text(angle = 70, hjust = 1))  + ggtitle("Influenza Positive Tests Reported to CDC \n by U.S. Clinical Laboratories 2017-2018 Season") + scale_colour_manual(labels()=cc("A","B", "5","c","a"))
plotS1 + geom_bar(aes(x = Week, y=as.numeric(as.character(Total.A))+ as.numeric(as.character(Total.B))),
fill="yellow",stat = "identity",labels = "A")+
geom_bar(aes(x = Week, y=as.numeric(as.character(Total.B))),fill="dark green",stat = "identity" , labels = "B")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.A))), colour="blue",group = 1,labels = "% Positive")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.B.))), colour="green",group = 1, labels = "% Positive Flu A")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(X..Positive))), colour="black",group = 1 , labels = "% Positive Flu B")+
scale_y_continuous("Number of Positive Specimen", sec.axis = sec_axis(~ . * 0.0015, name ="Percent Positive")) + theme(axis.text.x = element_text(angle = 70, hjust = 1))  + ggtitle("Influenza Positive Tests Reported to CDC \n by U.S. Clinical Laboratories 2017-2018 Season") + scale_colour_manual(labels=cc("A","B", "5","c","a"))
plotS1 + geom_bar(aes(x = Week, y=as.numeric(as.character(Total.A))+ as.numeric(as.character(Total.B))),
fill="yellow",stat = "identity",labels = "A")+
geom_bar(aes(x = Week, y=as.numeric(as.character(Total.B))),fill="dark green",stat = "identity" , labels = "B")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.A))), colour="blue",group = 1,labels = "% Positive")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.B.))), colour="green",group = 1, labels = "% Positive Flu A")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(X..Positive))), colour="black",group = 1 , labels = "% Positive Flu B")+
scale_y_continuous("Number of Positive Specimen", sec.axis = sec_axis(~ . * 0.0015, name ="Percent Positive")) + theme(axis.text.x = element_text(angle = 70, hjust = 1))  + ggtitle("Influenza Positive Tests Reported to CDC \n by U.S. Clinical Laboratories 2017-2018 Season") + scale_colour_manual(labels=c("A","B", "5","c","a"))
plotS1 + geom_bar(aes(x = Week, y=as.numeric(as.character(Total.A))+ as.numeric(as.character(Total.B))),
fill="yellow",stat = "identity",labels = "A")+
geom_bar(aes(x = Week, y=as.numeric(as.character(Total.B))),fill="dark green",stat = "identity" , labels = "B")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.A))), colour="blue",group = 1,labels = "% Positive")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(Percent.Positive.B.))), colour="green",group = 1, labels = "% Positive Flu A")+
geom_line(aes(x=Week, y=700*as.numeric(as.character(X..Positive))), colour="black",group = 1 , labels = "% Positive Flu B")+
scale_y_continuous("Number of Positive Specimen", sec.axis = sec_axis(~ . * 0.0015, name ="Percent Positive")) + theme(axis.text.x = element_text(angle = 70, hjust = 1))  + ggtitle("Influenza Positive Tests Reported to CDC \n by U.S. Clinical Laboratories 2017-2018 Season") + scale_colour_manual(values=c("A","B", "5","c","a"))
rm(list = ls())
getwd()
setwd("/Users/varadtupe/Documents/GitHub/CSE587_DIC/lab1/Part3")
load("~/Documents/GitHub/CSE587_DIC/lab1/Part3/Part3_2.RData")
library(ggmap)
library(twitteR)
setup_twitter_oauth("xxnT9Yq3j6YvATGT04E0C8ASH", "lVM3BFFTT8i1qjQhX9FM2CKdum6h8iVrCcZfqWntTk02oWm08M","57972043-A4xUZwhzLY9hCgwTRRYN2yytdRcTfayjQwELg8blm","NNivHGb0hEPjNCWwSogIUGSQ3SNPeLGnbL4gbyrxAhbE3")
searchStr = 'flu'
tdFlu = searchTwitter(searchStr, geocode='37.09024,-95.712891,1340mi',  n=5000, retryOnRateLimit=1)
tdFluDF = twListToDF(tdFlu)
mainFlu = rbind(mainFlu,tdFluDF)
searchStr = 'flu'
searchStr = 'fluvirus'
tdFlu = searchTwitter(searchStr,  geocode='37.09024,-95.712891,1340mi', n=10000, retryOnRateLimit=1)
tdFluDF = twListToDF(tdFlu)
mainFlu = rbind(mainFlu,tdFluDF)
searchStr = 'fluseason'
tdFlu = searchTwitter(searchStr,  geocode='37.09024,-95.712891,1340mi', n=10000, retryOnRateLimit=1)
tdFluDF = twListToDF(tdFlu)
mainFlu = rbind(mainFlu,tdFluDF)
searchStr = 'flushot'
tdFlu = searchTwitter(searchStr, geocode='37.09024,-95.712891,1340mi',  n=10000, retryOnRateLimit=1)
tdFluDF = twListToDF(tdFlu)
mainFlu = rbind(mainFlu,tdFluDF)
searchStr = 'influenza'
tdFlu = searchTwitter(searchStr, geocode='37.09024,-95.712891,1340mi',  n=10000, retryOnRateLimit=1)
tdFluDF = twListToDF(tdFlu)
mainFlu = rbind(mainFlu,tdFluDF)
filteredData = mainFlu[which(mainFlu$longitude != "NA"),]
filteredData = unique(mainFlu[which(mainFlu$longitude != "NA"),])
save.image("~/Documents/GitHub/CSE587_DIC/lab1/Part3/Part3_2.RData")
i=1
lt = as.numeric(filteredData$latitude[i])
lng = as.numeric(filteredData$longitude[i])
lng
lt
lng
gc = revgeocode(c(lt,lng), output = "all")
lt = (filteredData$latitude[i])
lng = (filteredData$longitude[i])
lt
lng
gc = revgeocode(c(lt,lng), output = "all")
lt = as.numeric(filteredData$latitude[i])
lng = as.numeric(filteredData$longitude[i])
lt
lng
gc <- as.numeric(geocode('Baylor University')) )
gc <- as.numeric(geocode('Baylor University'))
gc
pos = c(lt,lng)
lt = as.numeric(filteredData$latitude[i])
lng = as.numeric(filteredData$longitude[i])
lt
lng
pos = c(lt,lng)
gc = revgeocode(pos, output = "all")
pos = c(lng ,lt)
rgc = revgeocode(pos, output = "all")
for(i in 1:nrow(filteredData)){
lt = as.numeric(filteredData$latitude[i])
lng = as.numeric(filteredData$longitude[i])
# lt
# lng
gc = revgeocode(c(lng,lt), output = "all")
filteredData$statename[i] = tolower(gc$results[[1]]$address_components[[6]]$long_name)
print(filteredData$statename[i])
}
i=1
lt = as.numeric(filteredData$latitude[i])
lng = as.numeric(filteredData$longitude[i])
lt
lng
pos = c(lng ,lt)
rgc = revgeocode(pos, output = "all")
rgc
rgc = revgeocode(pos, output = "all", key = apiKey)
rgc
apiKey = "AIzaSyA-GqNhvaYfUVdfPH6Tlg66w20Hiym8bj4"
rgc = revgeocode(pos, output = "all", key = apiKey)
rgc = revgeocode(pos, output = "all",client = apiKey)
install.packages("googleway")
library(googleway)
grg = google_reverse_geocode(location = pos,
key = apikey)
apiKey = "AIzaSyA-GqNhvaYfUVdfPH6Tlg66w20Hiym8bj4"
grg = google_reverse_geocode(location = pos,
key = apikey)
apiKey = "AIzaSyA-GqNhvaYfUVdfPH6Tlg66w20Hiym8bj4"
grg = google_reverse_geocode(location = pos,
key = apikey)
grg = google_reverse_geocode(location = pos,
key = "AIzaSyA-GqNhvaYfUVdfPH6Tlg66w20Hiym8bj4")
grg = google_reverse_geocode(location = pos, key = "AIzaSyA-GqNhvaYfUVdfPH6Tlg66w20Hiym8bj4")
apiKey = "AIzaSyAEJlMozuo5KhQR34VCfnR_HhfBDZNdk5I"
grg = google_reverse_geocode(location = pos, key = "AIzaSyAEJlMozuo5KhQR34VCfnR_HhfBDZNdk5I")
rgc = revgeocode(pos, output = "all")
rgc
for(i in 1:nrow(filteredData)){
lt = as.numeric(filteredData$latitude[i])
lng = as.numeric(filteredData$longitude[i])
# lt
# lng
gc = revgeocode(c(lng,lt), output = "all",key = apiKey)
pr
filteredData$statename[i] = tolower(gc$results[[1]]$address_components[[6]]$long_name)
print(filteredData$statename[i])
}
for(i in 1:nrow(filteredData)){
lt = as.numeric(filteredData$latitude[i])
lng = as.numeric(filteredData$longitude[i])
# lt
# lng
gc = revgeocode(c(lng,lt), output = "all")
pr
filteredData$statename[i] = tolower(gc$results[[1]]$address_components[[6]]$long_name)
print(filteredData$statename[i])
}
for(i in 1:nrow(filteredData)){
lt = as.numeric(filteredData$latitude[i])
lng = as.numeric(filteredData$longitude[i])
# lt
# lng
gc = revgeocode(c(lng,lt), output = "all")
filteredData$statename[i] = tolower(gc$results[[1]]$address_components[[6]]$long_name)
print(filteredData$statename[i])
}
for(i in 1:nrow(filteredData)){
lt = as.numeric(filteredData$latitude[i])
lng = as.numeric(filteredData$longitude[i])
# lt
# lng
gc = revgeocode(c(lng,lt), output = "all")
print(filteredData$statename[i])
filteredData$statename[i] = tolower(gc$results[[1]]$address_components[[6]]$long_name)
}
for(i in 1:nrow(filteredData)){
lt = as.numeric(filteredData$latitude[i])
lng = as.numeric(filteredData$longitude[i])
# lt
# lng
gc = revgeocode(c(lng,lt), output = "all")
print(gc)
filteredData$statename[i] = tolower(gc$results[[1]]$address_components[[6]]$long_name)
}
View(filteredData)
View(filteredData)
mapgilbert <- get_map(location = c(lon = filteredData$longitude, lat = filteredData$latitude), zoom = 4,
maptype = "satellite", scale = 2)
mapgilbert <- get_map(location = c(lon = -95.712891 , lat = 37.09024,), zoom = 4,
maptype = "satellite", scale = 2)
mapgilbert <- get_map(location = c(lon = -95.712891 , lat = 37.09024), zoom = 4,
maptype = "satellite", scale = 2)
ggmap(mapgilbert) +
geom_point(data = df, aes(x = filteredData$longitude, y = filteredData$latitude, fill = "red", alpha = 0.8), size = 5, shape = 21) +
guides(fill=FALSE, alpha=FALSE, size=FALSE)
ggmap(mapgilbert) +
geom_point(data = filteredData, aes(x = filteredData$longitude, y = filteredData$latitude, fill = "red", alpha = 0.8), size = 5, shape = 21) +
guides(fill=FALSE, alpha=FALSE, size=FALSE)
ggmap(mapgilbert) +
geom_point(data = filteredData, aes(x = filteredData$longitude, y = filteredData$latitude, fill = "red", alpha = 0.8), size = 5, shape = 21)
ggmap(mapgilbert) +
geom_point(data = filteredData, aes(x = filteredData$longitude, y = filteredData$latitude, fill = "red", alpha = 0.8), size = 5, shape = 21)
ggmap(mapgilbert) +
geom_point(data = filteredData, aes(x = as.numeric(filteredData$longitude), y = as.numeric(filteredData$latitude), fill = "red", alpha = 0.8), size = 5, shape = 21)
tdFluDF
filteredData
rgc
for(i in 1:nrow(filteredData)){
lt = as.numeric(filteredData$latitude[i])
lng = as.numeric(filteredData$longitude[i])
# lt
# lng
gc = revgeocode(c(lng,lt), output = "all")
print(gc)
if(gc$results[[1]] == )
filteredData$statename[i] = tolower(gc$results[[1]]$address_components[[6]]$long_name)
}
for(i in 1:nrow(filteredData)){
lt = as.numeric(filteredData$latitude[i])
lng = as.numeric(filteredData$longitude[i])
# lt
# lng
gc = revgeocode(c(lng,lt), output = "all")
print(gc)
filteredData$statename[i] = tolower(gc$results[[1]]$address_components[[6]]$long_name)
}
save.image("~/Documents/GitHub/CSE587_DIC/lab1/Part3/Part3_2.RData")
