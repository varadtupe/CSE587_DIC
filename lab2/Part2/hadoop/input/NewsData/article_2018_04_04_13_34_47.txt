MIAMI — The Florida State Senate shocked even itself on Saturday when it voted to approve a two-year moratorium on sales of AR-15 semiautomatic rifles, going far beyond the gun-related measures that Republican legislative leaders said they would consider.Tellingly, though, that two-year moratorium lasted only 15 minutes.It had been approved by a voice vote, and opponents quickly insisted on reconsidering it, this time with a roll call to formally record how each senator voted. Evidently that turned some of the ayes heard by the Senate president into nays, because the proposal was defeated, 21 to 17.The moratorium episode — the closest that Florida’s Democratic gun-control proponents have come to success after a Feb. 14 shooting rampage, at a high school in Parkland, left 17 people dead — illustrates why it is so difficult to pass firearm restrictions in the State Legislature: When it comes to backing a significant change, even a popular one, the votes just aren’t there.In the rare Saturday session, the Senate debated a Republican-sponsored bill that would raise the minimum age to purchase a firearm to 21 from 18; mandate a three-day waiting period for most gun purchases; ban bump stocks, which enable semiautomatic rifles to fire much faster; and set up a voluntary program to arm trained schoolteachers and pay them a stipend to participate.Democrats offered a slew of amendments over eight hours of debate on the bill, including a permanent ban on assault weapons and the elimination of the armed-teacher program. Both of those changes would be popular with Florida voters: A Quinnipiac University poll released last week showed that 62 percent favored an assault weapons ban and 56 percent opposed giving teachers firearms.The 15 Democrats in the State Senate presented a united front, but it mattered little. Republicans hold 23 of the Senate’s 40 seats (two are vacant), leaving Democrats with too few votes to block bills on their own. And though the map of State Senate districts was redrawn by court order in 2016 to make it more fair, only a few Republican senators represent competitive districts, where voting against gun control might hurt them in a general election.As a result, Democrats managed to get just one amendment passed: adding 12 hours of required diversity training for participants in the program to arm teachers. That was meant to address black lawmakers’ concerns that teachers with guns might discriminate against black students in deciding when to use them.Students from the school in Parkland, Marjory Stoneman Douglas High, sprang into political action after losing classmates and teachers in the Feb. 14 mass shooting. They traveled by the busload to Tallahassee, meeting with lawmakers, chanting in hallways and protesting on the steps of the State Capitol in favor of stricter gun laws.But Parkland is in Broward County, the most heavily Democratic county in Florida. No Republican senator represents any part of the county; there was no chance of one of them breaking party ranks to side with student survivors from the district.The only two Republican senators who did consistently vote with the Democrats on Saturday were Anitere Flores and René García, representing neighboring Miami-Dade County. That is Florida’s most populous and most urban county, where even Republican constituents tend to be less strident about gun rights than in the rest of the state.A third Republican senator, Tom Lee, from the Tampa Bay area, joined in efforts to scrap the statewide armed-teacher program, which he called needlessly divisive, noting that local sheriffs and school superintendents can already set up such programs where they are wanted.Gov. Rick Scott, a Republican, has maintained that he does not want to arm teachers. He is widely expected to run for a United States Senate seat this year, and knows he will have to appeal to voters beyond his own party in a race against the incumbent Democrat, Bill Nelson.But the calculus is different for the speaker of the House, Richard Corcoran, a likely candidate for governor in a crowded Republican field. Mr. Corcoran would like to appeal to President Trump’s voter base in his party’s primary, and he has backed the armed-teacher program enthusiastically, calling it a “game changer.”The Senate president, Joe Negron, also a Republican, suggested a possible compromise on Friday, arming noninstructional school personnel rather than teachers. Mr. Scott did not respond last week when asked whether he would accept that.One way or another, though, Mr. Scott has said he is determined to pass the gun package, which would also include significant funding for school safety and mental health measures, before the end of the annual legislative session, which is scheduled to wrap up on Friday.